<!DOCTYPE html>
<html>
<head>
    <title>결과</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f4f4f4;
        }

        h1 {
            color: #333;
            margin-top: 20px;
        }

        .report-container {
            width: 90%;
            max-width: 800px;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .report-section-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .report-section-content {
            margin-bottom: 10px;
            color: #333;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        button {
            width: auto;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            background-color: #3498db;
            color: white;
            cursor: pointer;
            margin-top: 20px;
        }

        button:hover {
            background-color: #2980b9;
        }

        hr {
            width: 80%;
            border: 0;
            height: 1px;
            background-color: #ddd;
            margin: 20px 0;
        }

        .footer {
            text-align: center;
            font-size: 0.9em;
            color: #333;
        }

        .footer a {
            font-weight: bold;
            text-decoration: underline;
            margin: 0 10px;
        }
    </style>
</head>
<body>
    <h1>개인 맞춤 진로 추천 보고서</h1>
    <div class="report-container">
        {% if ai_response %}
            {% set lines = ai_response.split('\n') %}
            {% for line in lines %}
                {% if line.startswith('1.') or line.startswith('2.') or line.startswith('3.') or line.startswith('4.') or line.startswith('5.') or line.startswith('6.') or line.startswith('7.') %}
                    <div class="report-section-title">{{ line }}</div>
                {% else %}
                    <div class="report-section-content">{{ line }}</div>
                {% endif %}
            {% endfor %}
        {% endif %}
    </div>

    <a href="data:application/pdf;base64,{{ b64_pdf }}" download="report.pdf">
        <button>PDF 보고서 다운로드</button>
    </a>

    <hr>
    <div style="text-align: center;">
        <p>
            상호명: 블리스<br>
            사업자번호: 156-03-02826<br>
            대표자명: 이흥수<br>
            이메일: 94hslee@naver.com<br>
            주소: 충청북도 청주시 서원구 모충동 130-6, 201호<br>
            전화번호: 000-0000-0000
        </p>
        <div style="display: flex; justify-content: center; align-items: center;">
            <a href="/privacy" style="margin-right: 15px;">개인정보처리방침</a>
            <a href="/terms">이용약관</a>
        </div>
    </div>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        var aiResponse = localStorage.getItem('aiResponse');
        if (!aiResponse) {
            // AI 응답이 localStorage에 없는 경우, 서버에서 전달받은 데이터를 사용
            aiResponse = "{{ ai_response | safe }}"; // Flask에서 전달한 ai_response 사용
            localStorage.setItem('aiResponse', aiResponse); // localStorage에 저장
        }
        displayAiResponse(aiResponse);
    });

    function displayAiResponse(aiResponse) {
        var reportContainer = document.querySelector('.report-container');
        var lines = aiResponse.split('\n');
        var htmlContent = lines.map(function(line) {
            if (line.match(/^\d+\./)) {
                return `<div class="report-section-title">${line}</div>`;
            } else {
                return `<div class="report-section-content">${line}</div>`;
            }
        }).join('');
        reportContainer.innerHTML = htmlContent;
    }
    </script>

    <!-- <script>
    document.addEventListener('DOMContentLoaded', function() {
        var aiResponse = localStorage.getItem('aiResponse');
        if (aiResponse) {
            displayAiResponse(aiResponse);
        } else {
            console.error("AI 응답을 불러올 수 없습니다.");
        }
    });

    function displayAiResponse(aiResponse) {
        var reportContainer = document.querySelector('.report-container');
        var lines = aiResponse.split('\n');
        var htmlContent = lines.map(function(line) {
            if (line.match(/^\d+\./)) {
                return `<div class="report-section-title">${line}</div>`;
            } else {
                return `<div class="report-section-content">${line}</div>`;
            }
        }).join('');
        reportContainer.innerHTML = htmlContent;
    }
    </script> -->

    <!-- <script>
        document.addEventListener('DOMContentLoaded', function() {
            var aiResponse = localStorage.getItem('aiResponse') || '{{ ai_response|tojson }}';
            console.log("사용된 aiResponse:", aiResponse);
            
            if (aiResponse) {
                displayAiResponse(aiResponse);
                localStorage.setItem('aiResponse', aiResponse);
            }
        });

        function displayAiResponse(aiResponse) {
            var reportContainer = document.querySelector('.report-container');
            var lines = aiResponse.split('\n');
            var htmlContent = lines.map(function(line) {
                if (line.match(/^\d+\./)) {
                    return `<div class="report-section-title">${line}</div>`;
                } else {
                    return `<div class="report-section-content">${line}</div>`;
                }
            }).join('');
            reportContainer.innerHTML = htmlContent;
            console.log("화면에 데이터 표시 완료.");
        }
    </script>     -->

</body>
</html>